job "jfrog" {
  datacenters = ["dc1"]
  type = "batch"
  group "artifactory" {
	# This task invokes go-getter directly to pull an artifact
	task "directgogetter" {
  	driver = "raw_exec"
 
  	config {
    	# When running a binary that exists on the host, the path must be absolute path
    	command = "/tmp/go-getter"
 	   args    = ["http://admin:AKCp5bBD1fYq9WGUG4YLbotvAqgcYhGTTniAcsMSv1zDQYpJ12zw18tZ61bJhYKDqC5XoMgxD@https://partner1.jfrog.team/artifactory/artifactory/libs-release/5.1.4/connector-java-5.1.4-bin.jar", "/tmp/artifacts/"]
  	}
	}
	# This task pulls images via the docker driver
	task "pulldocker" {
  	driver = "docker"
  	config {
    	command = "/bin/echo"
    	args    = ["DONE"]
    	image = "RT_DOCKER/fabric8/s2i-java"
    	auth {
      	username = "admin"
      	password = "password"
      	server_address = "ARTIFACTORY_URL"
      	}
  	}
  	resources {
    	cpu = 500 # 500 Mhz
    	memory = 512 # 256MB
  	}
	}
	# This task invokes go-getter via the artifacts directive
	task "getartifacts" {
  	driver = "raw_exec"
  	config {
    	# When running a binary that exists on the host, the path must be absolute/
    	command = "/usr/bin/touch"
        args    = ["/tmp/ARTIFACT_DOWNLOAD_DONE"]
  	}
	artifact {
  	source  	= "http://ARTIFACTORY_USER:ARTIFACTORY_API@ARTIFACTORY_URL artifactory/libs-release/5.1.4/connector-java-5.1.4-bin.jar"
  	destination = "local/artifacts"
 	 }
	}
  }
}